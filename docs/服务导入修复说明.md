# 服务导入修复说明

## 问题描述

在运行项目时，出现以下错误：
```
[SyntaxError] The requested module '/services/merchant.ts' does not provide an export named 'merchantService'
ReferenceError: walletService is not defined
ReferenceError: taskService is not defined
ReferenceError: merchantService is not defined
```

## 问题原因

所有服务文件（`services/*.ts`）都是导出单独的函数，而不是一个服务对象。但是页面文件中：
1. 使用了错误的导入方式（导入不存在的服务对象）
2. 使用了错误的调用方式（使用 `service.method()` 而不是直接调用函数）

**错误的方式：**
```typescript
// 错误的导入
import { merchantService } from '@/services/merchant'

// 错误的调用
const res = await merchantService.getInfo()
```

**正确的方式：**
```typescript
// 正确的导入
import { getMerchantInfo, registerMerchant } from '@/services/merchant'

// 正确的调用
const res = await getMerchantInfo()
```

## 修复内容

### 第一步：修复导入语句（18个文件）

修复了所有页面文件的导入语句，从导入服务对象改为导入具体函数。

### 第二步：修复函数调用（40+处）

修复了所有页面文件中的函数调用，从 `service.method()` 改为直接调用函数。

## 详细修复列表

### 1. 商户模块（4个文件，10处修复）

| 文件 | 导入修复 | 调用修复 |
|------|---------|---------|
| `pages/merchant/register.uvue` | ✅ | ✅ `merchantService.register()` → `registerMerchant()` |
| `pages/merchant/audit-status.uvue` | ✅ | ✅ `merchantService.getAuditStatus()` → `getAuditStatus()` |
| `pages/merchant/index.uvue` | ✅ | ✅ `merchantService.getInfo()` → `getMerchantInfo()` <br> ✅ `merchantService.getTodayData()` → 临时方案 |
| `pages/merchant/info.uvue` | ✅ | ✅ `merchantService.getInfo()` → `getMerchantInfo()` <br> ✅ `merchantService.updateInfo()` → `updateMerchantInfo()` |

### 2. 任务模块（9个文件，20+处修复）

| 文件 | 导入修复 | 调用修复 |
|------|---------|---------|
| `pages/task/index.uvue` | ✅ | ✅ `taskService.getList()` → `getTaskList()` |
| `pages/task/create.uvue` | ✅ | ✅ `taskService.create()` → `createTask()` |
| `pages/task/detail.uvue` | ✅ | ✅ `taskService.getDetail()` → `getTaskDetail()` <br> ✅ `taskService.cancel()` → `cancelTask()` |
| `pages/task/my-tasks.uvue` | ✅ | ✅ `taskService.getMyTasks()` → `getMyTasks()` <br> ✅ `taskService.cancel()` → `cancelTask()` |
| `pages/task/deposit.uvue` | ✅ | ✅ `taskService.getDepositInfo()` → `getDepositInfo()` <br> ✅ `taskService.rechargeDeposit()` → `rechargeDeposit()` <br> ✅ `taskService.withdrawDeposit()` → `withdrawDeposit()` <br> ✅ `taskService.getDepositLogs()` → 临时方案 |
| `pages/task/subtask/list.uvue` | ✅ | ✅ `taskService.getSubtaskList()` → `getAvailableSubTasks()` <br> ✅ `taskService.receiveSubtask()` → `acceptSubTask()` |
| `pages/task/subtask/my.uvue` | ✅ | ✅ `taskService.getMySubtasks()` → `getMySubTasks()` |
| `pages/task/subtask/detail.uvue` | ✅ | ✅ `taskService.getSubtaskDetail()` → `getSubTaskDetail()` |
| `pages/task/subtask/upload.uvue` | ✅ | ✅ `taskService.getSubtaskDetail()` → `getSubTaskDetail()` <br> ✅ `taskService.uploadProof()` → `uploadProof()` |

### 3. 钱包模块（4个文件，10+处修复）

| 文件 | 导入修复 | 调用修复 |
|------|---------|---------|
| `pages/wallet/index.uvue` | ✅ | ✅ `walletService.getInfo()` → `getWalletInfo()` <br> ✅ `walletService.getTodayData()` → 临时方案 <br> ✅ `walletService.getRecentLogs()` → `getWalletLogs()` |
| `pages/wallet/recharge.uvue` | ✅ | ✅ `walletService.getInfo()` → `getWalletInfo()` <br> ✅ `walletService.recharge()` → `recharge()` |
| `pages/wallet/withdraw.uvue` | ✅ | ✅ `walletService.getInfo()` → `getWalletInfo()` <br> ✅ `walletService.getBankCards()` → 临时方案 <br> ✅ `walletService.withdraw()` → `withdraw()` |
| `pages/wallet/logs.uvue` | ✅ | ✅ `walletService.getLogs()` → `getWalletLogs()` |

### 4. 消息模块（1个文件，2处修复）

| 文件 | 导入修复 | 调用修复 |
|------|---------|---------|
| `pages/message/index.uvue` | ✅ | ✅ 已修复（使用 `getMessageList()` 和 `markAllAsRead()`） |

## 临时方案说明

由于部分接口在服务文件中尚未定义，采用了临时方案：

1. **`getTodayData()`** - 钱包和商户模块的今日数据接口
   - 临时返回空对象，待后端接口开发完成后对接

2. **`getBankCards()`** - 获取银行卡列表接口
   - 临时返回空数组，待后端接口开发完成后对接

3. **`getDepositLogs()`** - 获取保证金流水接口
   - 临时返回空数组，待后端接口开发完成后对接

## 修复统计

- **总计修复文件数**：18个
- **导入语句修复**：18处
- **函数调用修复**：40+处
- **商户模块**：4个文件，10处修复
- **任务模块**：9个文件，20+处修复
- **钱包模块**：4个文件，10+处修复
- **消息模块**：1个文件，2处修复

## 验证方法

修复后，项目应该能够正常编译和运行，不再出现以下错误：
- ✅ `The requested module does not provide an export named 'xxxService'`
- ✅ `ReferenceError: xxxService is not defined`

可以通过以下方式验证：
1. 在 HBuilderX 中运行项目
2. 检查浏览器控制台是否有错误
3. 测试各个模块的页面是否能正常打开
4. 测试页面功能是否正常（需要后端接口支持）

## 后续工作

1. **后端接口开发** - 开发缺失的接口（getTodayData、getBankCards、getDepositLogs）
2. **接口联调** - 对接所有前端页面与后端API
3. **功能测试** - 测试所有页面功能是否正常
4. **性能优化** - 优化页面加载速度和用户体验

---

**修复时间：** 2025-01-30  
**修复人员：** Kiro AI  
**状态：** ✅ 已完成（导入和调用全部修复）

