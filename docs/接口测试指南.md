# å•†æˆ·äº’åŠ©å¹³å° - æ¥å£æµ‹è¯•æŒ‡å—

> æ›´æ–°æ—¶é—´ï¼š2025-02-02  
> çŠ¶æ€ï¼šå¾…æµ‹è¯•

---

## ğŸ“‹ æµ‹è¯•å‡†å¤‡

### 1. ç¯å¢ƒé…ç½®

**åç«¯ç¯å¢ƒï¼š**
- PHP â‰¥ 7.4
- MySQL â‰¥ 5.7
- WebæœåŠ¡å™¨ï¼ˆApache/Nginxï¼‰
- åç«¯åœ°å€ï¼š`http://127.0.0.1:80`

**å‰ç«¯ç¯å¢ƒï¼š**
- HBuilderX â‰¥ 3.8.0
- å‰ç«¯åœ°å€ï¼š`http://127.0.0.1:9900`

### 2. æ•°æ®åº“åˆå§‹åŒ–

**æ‰§è¡ŒSQLæ–‡ä»¶ï¼ˆæŒ‰é¡ºåºï¼‰ï¼š**
```bash
cd backend/database
mysql -u root -p fastadmin < 01_promo_tables.sql
mysql -u root -p fastadmin < 02_merchant_tables.sql
mysql -u root -p fastadmin < 03_task_tables.sql
mysql -u root -p fastadmin < 04_wallet_tables.sql
mysql -u root -p fastadmin < 05_config_tables.sql
mysql -u root -p fastadmin < 06_init_data.sql
```

### 3. æµ‹è¯•å·¥å…·

**æ¨èä½¿ç”¨ï¼š**
- Postmanï¼ˆæ¨èï¼‰
- Apifox
- æˆ–å…¶ä»–APIæµ‹è¯•å·¥å…·

---

## ğŸ”‘ è®¤è¯è¯´æ˜

æ‰€æœ‰æ¥å£éƒ½éœ€è¦Tokenè®¤è¯ï¼ˆé™¤äº†ç™»å½•å’Œæ³¨å†Œæ¥å£ï¼‰ã€‚

**è¯·æ±‚å¤´ï¼š**
```
Token: your_token_here
```

**è·å–Tokenï¼š**
é€šè¿‡ç™»å½•æ¥å£è·å–ï¼Œæˆ–åœ¨æ•°æ®åº“ä¸­æŸ¥è¯¢ç”¨æˆ·çš„tokenå­—æ®µã€‚

---

## ğŸ“ æ¥å£æ¸…å•

### è®¤è¯æ¨¡å—ï¼ˆ2ä¸ªæ¥å£ï¼‰

#### 1. ç”¨æˆ·ç™»å½•

**æ¥å£ï¼š** `POST /api/user/login`

**è¯·æ±‚å‚æ•°ï¼š**
```json
{
  "account": "13800138000",
  "password": "123456"
}
```

**è¿”å›ç¤ºä¾‹ï¼š**
```json
{
  "code": 0,
  "message": "ç™»å½•æˆåŠŸ",
  "data": {
    "userinfo": {
      "id": 1,
      "username": "user001",
      "nickname": "æµ‹è¯•ç”¨æˆ·",
      "mobile": "13800138000",
      "avatar": "",
      "level_id": 1
    },
    "token": "xxxxxx"
  }
}
```

#### 2. ç”¨æˆ·æ³¨å†Œ

**æ¥å£ï¼š** `POST /api/user/register`

**è¯·æ±‚å‚æ•°ï¼š**
```json
{
  "username": "user001",
  "password": "123456",
  "mobile": "13800138000",
  "code": "123456",
  "invite_code": "ABC123"
}
```

---

### å•†æˆ·æ¨¡å—ï¼ˆ4ä¸ªæ¥å£ï¼‰

#### 1. è·å–å•†æˆ·ä¿¡æ¯

**æ¥å£ï¼š** `GET /api/merchant/info`

**è¯·æ±‚å¤´ï¼š**
```
Token: your_token_here
```

**è¿”å›ç¤ºä¾‹ï¼š**
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "id": 1,
    "user_id": 1,
    "merchant_no": "M202501010001",
    "company_name": "æµ‹è¯•å…¬å¸",
    "status": "approved",
    "entry_fee": 1000.00,
    "createtime": 1704067200
  }
}
```

#### 2. å•†æˆ·æ³¨å†Œ/è¿›ä»¶

**æ¥å£ï¼š** `POST /api/merchant/register`

**è¯·æ±‚å‚æ•°ï¼š**
```json
{
  "company_name": "æµ‹è¯•å…¬å¸",
  "legal_person": "å¼ ä¸‰",
  "id_card": "110101199001011234",
  "business_license": "https://example.com/license.jpg",
  "contact_name": "å¼ ä¸‰",
  "contact_mobile": "13800138000",
  "bank_name": "ä¸­å›½é“¶è¡Œ",
  "bank_account": "6222021234567890",
  "bank_account_name": "å¼ ä¸‰"
}
```

#### 3. è·å–å®¡æ ¸çŠ¶æ€

**æ¥å£ï¼š** `GET /api/merchant/auditStatus`

**è¿”å›ç¤ºä¾‹ï¼š**
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "status": "pending",
    "audit_time": null,
    "audit_remark": null,
    "merchant": {
      "id": 1,
      "merchant_no": "M202501010001",
      "company_name": "æµ‹è¯•å…¬å¸"
    }
  }
}
```

#### 4. æ”¯ä»˜å…¥é©»è´¹

**æ¥å£ï¼š** `POST /api/merchant/payEntryFee`

**è¯·æ±‚å‚æ•°ï¼š**
```json
{
  "pay_type": "balance"
}
```

---

### ä»»åŠ¡æ¨¡å—ï¼ˆ11ä¸ªæ¥å£ï¼‰

#### 1. ä»»åŠ¡åˆ—è¡¨

**æ¥å£ï¼š** `GET /api/task/list`

**è¯·æ±‚å‚æ•°ï¼š**
```
page=1&limit=10&status=running
```

#### 2. ä»»åŠ¡è¯¦æƒ…

**æ¥å£ï¼š** `GET /api/task/detail`

**è¯·æ±‚å‚æ•°ï¼š**
```
id=1
```

#### 3. å‘èµ·ä»»åŠ¡

**æ¥å£ï¼š** `POST /api/task/create`

**è¯·æ±‚å‚æ•°ï¼š**
```json
{
  "title": "æµ‹è¯•ä»»åŠ¡",
  "total_amount": 10000,
  "total_count": 5,
  "service_fee_rate": 0.05,
  "remark": "æµ‹è¯•ä»»åŠ¡è¯´æ˜"
}
```

#### 4. å–æ¶ˆä»»åŠ¡

**æ¥å£ï¼š** `POST /api/task/cancel`

**è¯·æ±‚å‚æ•°ï¼š**
```json
{
  "id": 1
}
```

#### 5. æˆ‘å‘èµ·çš„ä»»åŠ¡

**æ¥å£ï¼š** `GET /api/task/myTasks`

**è¯·æ±‚å‚æ•°ï¼š**
```
page=1&limit=10&status=running
```

#### 6. å¯æ¥å­ä»»åŠ¡åˆ—è¡¨

**æ¥å£ï¼š** `GET /api/task/subtaskAvailable`

**è¯·æ±‚å‚æ•°ï¼š**
```
page=1&limit=10
```

#### 7. æˆ‘æ¥çš„å­ä»»åŠ¡

**æ¥å£ï¼š** `GET /api/task/subtaskMy`

**è¯·æ±‚å‚æ•°ï¼š**
```
page=1&limit=10&status=accepted
```

#### 8. å­ä»»åŠ¡è¯¦æƒ…

**æ¥å£ï¼š** `GET /api/task/subtaskDetail`

**è¯·æ±‚å‚æ•°ï¼š**
```
id=1
```

#### 9. æ¥å—å­ä»»åŠ¡

**æ¥å£ï¼š** `POST /api/task/subtaskAccept`

**è¯·æ±‚å‚æ•°ï¼š**
```json
{
  "id": 1
}
```

#### 10. ä¸Šä¼ æ”¯ä»˜å‡­è¯

**æ¥å£ï¼š** `POST /api/task/subtaskUploadProof`

**è¯·æ±‚å‚æ•°ï¼š**
```json
{
  "id": 1,
  "proof_image": "https://example.com/proof.jpg"
}
```

#### 11. æ£€æŸ¥æ¥å•èµ„æ ¼

**æ¥å£ï¼š** `GET /api/task/canReceive`

**è¿”å›ç¤ºä¾‹ï¼š**
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "can_receive": true,
    "mutual_balance": 5000.00,
    "threshold": -50000.00
  }
}
```

---

### é’±åŒ…æ¨¡å—ï¼ˆ8ä¸ªæ¥å£ï¼‰

#### 1. é’±åŒ…ä¿¡æ¯

**æ¥å£ï¼š** `GET /api/wallet/info`

**è¿”å›ç¤ºä¾‹ï¼š**
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "balance": 10000.00,
    "frozen_balance": 0.00,
    "deposit_balance": 5000.00,
    "frozen_deposit": 0.00,
    "mutual_balance": 0.00
  }
}
```

#### 2. æµæ°´è®°å½•

**æ¥å£ï¼š** `GET /api/wallet/logs`

**è¯·æ±‚å‚æ•°ï¼š**
```
page=1&limit=10&type=recharge
```

#### 3. å……å€¼

**æ¥å£ï¼š** `POST /api/wallet/recharge`

**è¯·æ±‚å‚æ•°ï¼š**
```json
{
  "amount": 1000,
  "pay_type": "alipay"
}
```

#### 4. æç°ç”³è¯·

**æ¥å£ï¼š** `POST /api/wallet/withdraw`

**è¯·æ±‚å‚æ•°ï¼š**
```json
{
  "amount": 500,
  "bank_name": "ä¸­å›½é“¶è¡Œ",
  "bank_account": "6222021234567890",
  "bank_account_name": "å¼ ä¸‰"
}
```

#### 5. æç°è®°å½•

**æ¥å£ï¼š** `GET /api/wallet/withdrawRecords`

**è¯·æ±‚å‚æ•°ï¼š**
```
page=1&limit=10&status=pending
```

#### 6. å……å€¼ä¿è¯é‡‘

**æ¥å£ï¼š** `POST /api/wallet/depositPay`

**è¯·æ±‚å‚æ•°ï¼š**
```json
{
  "amount": 5000
}
```

#### 7. æå–ä¿è¯é‡‘

**æ¥å£ï¼š** `POST /api/wallet/depositWithdraw`

**è¯·æ±‚å‚æ•°ï¼š**
```json
{
  "amount": 1000
}
```

---

### æ¨å¹¿æ¨¡å—ï¼ˆ10ä¸ªæ¥å£ï¼‰

#### 1. æ¨å¹¿æ¦‚è§ˆ

**æ¥å£ï¼š** `GET /api/promo/overview`

**è¿”å›ç¤ºä¾‹ï¼š**
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "level": {
      "id": 2,
      "name": "åˆçº§ä»£ç†",
      "commission_rate": 0.01
    },
    "wallet": {
      "balance": 10000.00,
      "commission_total": 5000.00
    },
    "performance": {
      "personal": 50000.00,
      "team": 200000.00
    },
    "team": {
      "direct_count": 10,
      "total_count": 50
    }
  }
}
```

#### 2. ç­‰çº§åˆ—è¡¨

**æ¥å£ï¼š** `GET /api/promo/levels`

#### 3. è´­ä¹°ç­‰çº§

**æ¥å£ï¼š** `POST /api/promo/purchaseLevel`

**è¯·æ±‚å‚æ•°ï¼š**
```json
{
  "level_id": 2
}
```

#### 4. æˆ‘çš„é‚€è¯·ç 

**æ¥å£ï¼š** `GET /api/promo/myInviteCode`

**è¿”å›ç¤ºä¾‹ï¼š**
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "invite_code": "ABC123",
    "qrcode_url": "https://example.com/qrcode/ABC123.png"
  }
}
```

#### 5. ç»‘å®šä¸Šçº§

**æ¥å£ï¼š** `POST /api/promo/bindRelation`

**è¯·æ±‚å‚æ•°ï¼š**
```json
{
  "invite_code": "ABC123"
}
```

#### 6. æˆ‘çš„å›¢é˜Ÿ

**æ¥å£ï¼š** `GET /api/promo/myTeam`

**è¯·æ±‚å‚æ•°ï¼š**
```
page=1&limit=10&depth=1
```

#### 7. ä½£é‡‘è®°å½•

**æ¥å£ï¼š** `GET /api/promo/commissionList`

**è¯·æ±‚å‚æ•°ï¼š**
```
page=1&limit=10&type=direct
```

#### 8. é’±åŒ…æµæ°´

**æ¥å£ï¼š** `GET /api/promo/walletLogs`

**è¯·æ±‚å‚æ•°ï¼š**
```
page=1&limit=10
```

#### 9. ä¸šç»©ç»Ÿè®¡

**æ¥å£ï¼š** `GET /api/promo/performanceSummary`

**è¯·æ±‚å‚æ•°ï¼š**
```
month=2025-01
```

#### 10. åˆ†çº¢æ¦‚è§ˆ

**æ¥å£ï¼š** `GET /api/promo/bonusSummary`

**è¿”å›ç¤ºä¾‹ï¼š**
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "total_bonus": 10000.00,
    "this_month_bonus": 2000.00,
    "qualified_configs": [
      {
        "id": 1,
        "name": "åŸºç¡€åˆ†çº¢",
        "pool_rate": 0.01
      }
    ]
  }
}
```

---

## ğŸ§ª æµ‹è¯•æµç¨‹

### 1. å®Œæ•´ä¸šåŠ¡æµç¨‹æµ‹è¯•

#### æµç¨‹1ï¼šå•†æˆ·å…¥é©»æµç¨‹

**æ­¥éª¤ï¼š**
1. ç”¨æˆ·æ³¨å†Œ â†’ `POST /api/user/register`
2. ç”¨æˆ·ç™»å½• â†’ `POST /api/user/login`
3. å•†æˆ·æ³¨å†Œ â†’ `POST /api/merchant/register`
4. æŸ¥çœ‹å®¡æ ¸çŠ¶æ€ â†’ `GET /api/merchant/auditStatus`
5. åå°å®¡æ ¸é€šè¿‡ï¼ˆéœ€è¦åœ¨åå°æ“ä½œï¼‰
6. æ”¯ä»˜å…¥é©»è´¹ â†’ `POST /api/merchant/payEntryFee`
7. éªŒè¯æ¨èäººè·å¾—å¥–åŠ±

#### æµç¨‹2ï¼šäº’åŠ©ä»»åŠ¡æµç¨‹

**æ­¥éª¤ï¼š**
1. å‘èµ·ä»»åŠ¡ â†’ `POST /api/task/create`
2. å……å€¼ä¿è¯é‡‘ â†’ `POST /api/wallet/depositPay`
3. åå°å®¡æ ¸ä»»åŠ¡ï¼ˆéœ€è¦åœ¨åå°æ“ä½œï¼‰
4. ç³»ç»Ÿè‡ªåŠ¨æ´¾å‘å­ä»»åŠ¡
5. æŸ¥çœ‹å¯æ¥ä»»åŠ¡ â†’ `GET /api/task/subtaskAvailable`
6. æ¥å—å­ä»»åŠ¡ â†’ `POST /api/task/subtaskAccept`
7. ä¸Šä¼ æ”¯ä»˜å‡­è¯ â†’ `POST /api/task/subtaskUploadProof`
8. ç³»ç»Ÿè‡ªåŠ¨å®Œæˆç»“ç®—
9. éªŒè¯ä½£é‡‘å‘æ”¾

#### æµç¨‹3ï¼šæ¨å¹¿æµç¨‹

**æ­¥éª¤ï¼š**
1. è·å–é‚€è¯·ç  â†’ `GET /api/promo/myInviteCode`
2. æ–°ç”¨æˆ·æ³¨å†Œæ—¶å¡«å†™é‚€è¯·ç 
3. è´­ä¹°ç­‰çº§ â†’ `POST /api/promo/purchaseLevel`
4. æŸ¥çœ‹å›¢é˜Ÿ â†’ `GET /api/promo/myTeam`
5. æŸ¥çœ‹ä½£é‡‘ â†’ `GET /api/promo/commissionList`
6. æŸ¥çœ‹ä¸šç»© â†’ `GET /api/promo/performanceSummary`
7. æŸ¥çœ‹åˆ†çº¢ â†’ `GET /api/promo/bonusSummary`

---

## âœ… æµ‹è¯•æ£€æŸ¥æ¸…å•

### åŠŸèƒ½æµ‹è¯•

- [ ] ç”¨æˆ·æ³¨å†Œç™»å½•
- [ ] å•†æˆ·å…¥é©»æµç¨‹
- [ ] ä»»åŠ¡å‘èµ·å’Œå®¡æ ¸
- [ ] å­ä»»åŠ¡æ´¾å‘å’Œæ¥å•
- [ ] æ”¯ä»˜å‡­è¯ä¸Šä¼ 
- [ ] ä»»åŠ¡å®Œæˆç»“ç®—
- [ ] é’±åŒ…å……å€¼æç°
- [ ] ä¿è¯é‡‘ç®¡ç†
- [ ] æ¨å¹¿å…³ç³»ç»‘å®š
- [ ] ç­‰çº§è´­ä¹°å‡çº§
- [ ] ä½£é‡‘å‘æ”¾
- [ ] ä¸šç»©ç»Ÿè®¡
- [ ] åˆ†çº¢è®¡ç®—

### ä¸šåŠ¡é€»è¾‘æµ‹è¯•

- [ ] äº’åŠ©ä½™é¢è®¡ç®—æ­£ç¡®
- [ ] ä¿è¯é‡‘å†»ç»“è§£å†»æ­£ç¡®
- [ ] å¥–åŠ±è§¦å‘æ­£ç¡®ï¼ˆç›´æ¨å¥–ã€é—´æ¨å¥–ï¼‰
- [ ] ç­‰çº§å·®åˆ†æ¶¦æ­£ç¡®
- [ ] ä¸šç»©ç»Ÿè®¡æ­£ç¡®ï¼ˆä¸ªäººã€å›¢é˜Ÿï¼‰
- [ ] åˆ†çº¢è®¡ç®—æ­£ç¡®
- [ ] è‡ªåŠ¨å‡çº§æ£€æŸ¥æ­£ç¡®

### å¼‚å¸¸æµ‹è¯•

- [ ] ä½™é¢ä¸è¶³æ—¶çš„å¤„ç†
- [ ] ä¿è¯é‡‘ä¸è¶³æ—¶çš„å¤„ç†
- [ ] é‡å¤æ“ä½œçš„å¤„ç†
- [ ] å‚æ•°é”™è¯¯çš„å¤„ç†
- [ ] æƒé™ä¸è¶³çš„å¤„ç†
- [ ] å¹¶å‘æ“ä½œçš„å¤„ç†

---

## ğŸ“Š æµ‹è¯•æŠ¥å‘Šæ¨¡æ¿

### æµ‹è¯•ç¯å¢ƒ

- åç«¯åœ°å€ï¼šhttp://127.0.0.1:80
- å‰ç«¯åœ°å€ï¼šhttp://127.0.0.1:9900
- æ•°æ®åº“ç‰ˆæœ¬ï¼šMySQL 5.7
- PHPç‰ˆæœ¬ï¼š7.4

### æµ‹è¯•ç»“æœ

| æ¨¡å— | æ¥å£æ•° | é€šè¿‡ | å¤±è´¥ | é€šè¿‡ç‡ |
|------|--------|------|------|--------|
| è®¤è¯æ¨¡å— | 2 | - | - | - |
| å•†æˆ·æ¨¡å— | 4 | - | - | - |
| ä»»åŠ¡æ¨¡å— | 11 | - | - | - |
| é’±åŒ…æ¨¡å— | 8 | - | - | - |
| æ¨å¹¿æ¨¡å— | 10 | - | - | - |
| **æ€»è®¡** | **35** | **-** | **-** | **-%** |

### é—®é¢˜è®°å½•

| ç¼–å· | æ¥å£ | é—®é¢˜æè¿° | ä¸¥é‡ç¨‹åº¦ | çŠ¶æ€ |
|------|------|----------|----------|------|
| 1 | - | - | - | - |

---

**æ–‡æ¡£åˆ›å»ºæ—¶é—´ï¼š** 2025-02-02  
**å½“å‰çŠ¶æ€ï¼š** å¾…æµ‹è¯•  
**ä¸‹ä¸€æ­¥ï¼š** æ‰§è¡Œæ¥å£æµ‹è¯•ï¼Œè®°å½•æµ‹è¯•ç»“æœ
