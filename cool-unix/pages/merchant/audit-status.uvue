<template>
	<view class="flex flex-col h-screen bg-[#f5f7fa]">
		<!-- 顶部导航 -->
		<cl-topbar title="审核状态" :show-back="true" background-color="#ffffff" color="#1f2329" safe-area-top></cl-topbar>

		<!-- 内容区域 -->
		<scroll-view class="flex-1 h-0" scroll-y>
			<!-- 审核状态卡片 -->
			<view class="p-[32rpx] flex flex-col gap-[24rpx]">
				<!-- 审核中 -->
				<view v-if="auditInfo.status === 'pending'" class="bg-white rounded-[24rpx] p-[32rpx]">
					<view class="flex flex-col items-center py-[48rpx]">
						<uni-icons type="time-filled" size="64" color="#ff9500" class="mb-[24rpx]"></uni-icons>
						<text class="text-[36rpx] font-bold text-[#1f2329] mb-[16rpx]">审核中</text>
						<text class="text-[28rpx] text-[#646a73]">您的入驻申请正在审核中，请耐心等待</text>
						<text class="text-[28rpx] text-[#999999] mt-[16rpx]">预计1-3个工作日完成审核</text>
					</view>

					<view class="border-t-[2rpx] border-[#e5e5e5] pt-[32rpx] flex flex-col gap-[24rpx]">
						<view class="flex justify-between items-center">
							<text class="text-[28rpx] text-[#999999]">提交时间</text>
							<text class="text-[28rpx] text-[#1f2329]">{{ auditInfo.submitTime }}</text>
						</view>
						<view class="flex justify-between items-center">
							<text class="text-[28rpx] text-[#999999]">审核编号</text>
							<text class="text-[28rpx] text-[#1f2329]">{{ auditInfo.auditNo }}</text>
						</view>
					</view>
				</view>

				<!-- 审核通过 -->
				<view v-if="auditInfo.status === 'approved'" class="bg-white rounded-[24rpx] p-[32rpx]">
					<view class="flex flex-col items-center py-[48rpx]">
						<uni-icons type="checkbox-filled" size="64" color="#0052d9" class="mb-[24rpx]"></uni-icons>
						<text class="text-[36rpx] font-bold text-[#0052d9] mb-[16rpx]">审核通过</text>
						<text class="text-[28rpx] text-[#646a73]">恭喜您，入驻申请已通过审核</text>
					</view>

					<view class="border-t-[2rpx] border-[#e5e5e5] pt-[32rpx] flex flex-col gap-[24rpx]">
						<view class="flex justify-between items-center">
							<text class="text-[28rpx] text-[#999999]">审核时间</text>
							<text class="text-[28rpx] text-[#1f2329]">{{ auditInfo.auditTime }}</text>
						</view>
						<view class="flex justify-between items-center">
							<text class="text-[28rpx] text-[#999999]">商户编号</text>
							<text class="text-[28rpx] text-[#1f2329]">{{ auditInfo.merchantNo }}</text>
						</view>
					</view>

					<view class="mt-[32rpx]">
						<button 
							@click="goToMerchant"
							class="w-full h-[88rpx] bg-[#0052d9] text-white rounded-full flex items-center justify-center"
						>
							<text class="text-[32rpx] font-medium">进入商户中心</text>
						</button>
					</view>
				</view>

				<!-- 审核驳回 -->
				<view v-if="auditInfo.status === 'rejected'" class="bg-white rounded-[24rpx] p-[32rpx]">
					<view class="flex flex-col items-center py-[48rpx]">
						<uni-icons type="clear-filled" size="64" color="#ff3b30" class="mb-[24rpx]"></uni-icons>
						<text class="text-[36rpx] font-bold text-[#ff3b30] mb-[16rpx]">审核未通过</text>
						<text class="text-[28rpx] text-[#646a73]">很抱歉，您的入驻申请未通过审核</text>
					</view>

					<view class="border-t-[2rpx] border-[#e5e5e5] pt-[32rpx] flex flex-col gap-[24rpx]">
						<view>
							<text class="text-[28rpx] text-[#999999] mb-[16rpx] block">驳回原因</text>
							<view class="bg-[#fff5f5] rounded-[16rpx] p-[24rpx]">
								<text class="text-[28rpx] text-[#ff3b30]">{{ auditInfo.rejectReason }}</text>
							</view>
						</view>
						<view class="flex justify-between items-center">
							<text class="text-[28rpx] text-[#999999]">审核时间</text>
							<text class="text-[28rpx] text-[#1f2329]">{{ auditInfo.auditTime }}</text>
						</view>
					</view>

					<view class="mt-[32rpx]">
						<button 
							@click="resubmit"
							class="w-full h-[88rpx] bg-[#0052d9] text-white rounded-full flex items-center justify-center"
						>
							<text class="text-[32rpx] font-medium">重新提交</text>
						</button>
					</view>
				</view>

				<!-- 申请信息 -->
				<view class="bg-white rounded-[24rpx] p-[32rpx]">
					<text class="text-[32rpx] font-bold text-[#1f2329] mb-[24rpx] block">申请信息</text>
					
					<view class="flex flex-col gap-[24rpx]">
						<view class="flex justify-between items-center">
							<text class="text-[28rpx] text-[#999999]">商户类型</text>
							<text class="text-[28rpx] text-[#1f2329]">{{ auditInfo.type === 'personal' ? '个人商户' : '企业商户' }}</text>
						</view>
						<view class="flex justify-between items-center">
							<text class="text-[28rpx] text-[#999999]">商户名称</text>
							<text class="text-[28rpx] text-[#1f2329]">{{ auditInfo.name }}</text>
						</view>
						<view class="flex justify-between items-center">
							<text class="text-[28rpx] text-[#999999]">联系人</text>
							<text class="text-[28rpx] text-[#1f2329]">{{ auditInfo.contact }}</text>
						</view>
						<view class="flex justify-between items-center">
							<text class="text-[28rpx] text-[#999999]">联系电话</text>
							<text class="text-[28rpx] text-[#1f2329]">{{ auditInfo.phone }}</text>
						</view>
						<view class="flex justify-between items-center">
							<text class="text-[28rpx] text-[#999999]">经营地址</text>
							<text class="text-[28rpx] text-[#1f2329]">{{ auditInfo.address }}</text>
						</view>
						<view class="flex justify-between items-center">
							<text class="text-[28rpx] text-[#999999]">经营类目</text>
							<text class="text-[28rpx] text-[#1f2329]">{{ auditInfo.category }}</text>
						</view>
					</view>
				</view>

				<!-- 审核进度 -->
				<view v-if="auditInfo.status === 'pending'" class="bg-white rounded-[24rpx] p-[32rpx]">
					<text class="text-[32rpx] font-bold text-[#1f2329] mb-[24rpx] block">审核进度</text>
					
					<view class="flex flex-col">
						<view class="flex items-start h-[120rpx]">
							<view class="flex flex-col items-center mr-[24rpx]">
								<view class="w-[48rpx] h-[48rpx] rounded-full bg-[#0052d9] flex items-center justify-center z-10">
									<uni-icons type="checkmarkempty" size="16" color="#ffffff"></uni-icons>
								</view>
								<view class="w-[4rpx] h-full bg-[#0052d9] -mt-[8rpx]"></view>
							</view>
							<view class="flex-1">
								<text class="text-[28rpx] text-[#1f2329] font-bold block">提交申请</text>
								<text class="text-[24rpx] text-[#999999] mt-[8rpx] block">{{ auditInfo.submitTime }}</text>
							</view>
						</view>

						<view class="flex items-start h-[120rpx]">
							<view class="flex flex-col items-center mr-[24rpx]">
								<view class="w-[48rpx] h-[48rpx] rounded-full bg-[#0052d9] flex items-center justify-center z-10">
									<uni-icons type="time-filled" size="16" color="#ffffff"></uni-icons>
								</view>
								<view class="w-[4rpx] h-full bg-[#e5e5e5] -mt-[8rpx]"></view>
							</view>
							<view class="flex-1">
								<text class="text-[28rpx] text-[#1f2329] font-bold block">资料审核</text>
								<text class="text-[24rpx] text-[#999999] mt-[8rpx] block">审核中...</text>
							</view>
						</view>

						<view class="flex items-start">
							<view class="flex flex-col items-center mr-[24rpx]">
								<view class="w-[48rpx] h-[48rpx] rounded-full bg-[#e5e5e5] flex items-center justify-center z-10">
									<text class="text-[24rpx] text-[#999999]">3</text>
								</view>
							</view>
							<view class="flex-1">
								<text class="text-[28rpx] text-[#999999] block">审核完成</text>
								<text class="text-[24rpx] text-[#999999] mt-[8rpx] block">等待审核</text>
							</view>
						</view>
					</view>
				</view>

				<!-- 温馨提示 -->
				<view class="bg-[#fff9e6] rounded-[16rpx] p-[32rpx] flex flex-col gap-[16rpx]">
					<view class="flex flex-row items-center gap-[8rpx]">
						<uni-icons type="info-filled" size="20" color="#ed6a0c"></uni-icons>
						<text class="text-[28rpx] text-[#ed6a0c] font-bold">温馨提示</text>
					</view>
					<view class="flex flex-col gap-[8rpx]">
						<text class="text-[26rpx] text-[#646a73]">• 审核时间：工作日9:00-18:00</text>
						<text class="text-[26rpx] text-[#646a73]">• 如有疑问，请联系客服：400-123-4567</text>
						<text class="text-[26rpx] text-[#646a73]">• 审核结果将通过短信和站内消息通知</text>
					</view>
				</view>
			</view>
		</scroll-view>
	</view>
</template>

<script setup lang="uts">
import { ref, onMounted } from 'vue'
import { getAuditStatus } from '@/services/merchant'

// 审核信息
const auditInfo = ref({
	status: 'pending', // pending: 审核中, approved: 通过, rejected: 驳回
	submitTime: '2025-01-29 10:30:00',
	auditTime: '',
	auditNo: 'A202501290001',
	merchantNo: '',
	rejectReason: '',
	type: 'personal',
	name: '',
	contact: '',
	phone: '',
	address: '',
	category: ''
})

// 加载审核状态
const loadAuditStatus = async () => {
	try {
		uni.showLoading({ title: '加载中...' })
		
		const res = await getAuditStatus()
		
		uni.hideLoading()
		
		if (res.code === 0) {
			auditInfo.value = res.data
		}
	} catch (error) {
		uni.hideLoading()
		uni.showToast({
			title: '加载失败',
			icon: 'none'
		})
	}
}

// 进入商户中心
const goToMerchant = () => {
	uni.redirectTo({
		url: '/pages/merchant/index'
	})
}

// 重新提交
const resubmit = () => {
	uni.redirectTo({
		url: '/pages/merchant/register'
	})
}

// 页面加载时获取审核状态
onMounted(() => {
	loadAuditStatus()
})
</script>
