<template>
	<view class="page-container">
		<!-- Header -->
		<view class="promo-header">
			<view class="header-nav">
				<text class="nav-title">æ¨å¹¿ä¸­å¿ƒ</text>
			</view>
			
			<view class="header-card">
				<!-- Stats -->
				<view class="stats-row">
					<view class="stat-item">
						<text class="stat-num">{{ overview?.wallet?.balance || '0.00' }}</text>
						<text class="stat-desc">å¯æç°(å…ƒ)</text>
					</view>
					<view class="stat-item">
						<text class="stat-num">{{ overview?.wallet?.total_income || '0.00' }}</text>
						<text class="stat-desc">ç´¯è®¡æ”¶ç›Š(å…ƒ)</text>
					</view>
					<view class="stat-item">
						<text class="stat-num">{{ overview?.team_count || 0 }}</text>
						<text class="stat-desc">å›¢é˜Ÿäººæ•°</text>
					</view>
				</view>

				<!-- Quick Actions -->
				<view class="quick-row">
					<view class="quick-item" @tap="goTo('/pages/wallet/withdraw')">
						<view class="quick-icon-box">
							<uni-icons type="vip" size="22" color="#0052d9"></uni-icons>
						</view>
						<text class="quick-text">ç«‹å³æç°</text>
					</view>
					<view class="quick-item" @tap="goTo('/pages/promo/invite')">
						<view class="quick-icon-box">
							<uni-icons type="contact" size="22" color="#00b578"></uni-icons>
						</view>
						<text class="quick-text">é‚€è¯·å¥½å‹</text>
					</view>
					<view class="quick-item" @tap="goTo('/pages/promo/commission')">
						<view class="quick-icon-box">
							<uni-icons type="wallet" size="22" color="#faad14"></uni-icons>
						</view>
						<text class="quick-text">ä½£é‡‘æ˜ç»†</text>
					</view>
					<view class="quick-item" @tap="goTo('/pages/promo/team')">
						<view class="quick-icon-box">
							<uni-icons type="bars" size="22" color="#5856d6"></uni-icons>
						</view>
						<text class="quick-text">å›¢é˜Ÿç®¡ç†</text>
					</view>
				</view>
			</view>
		</view>

		<scroll-view class="content" scroll-y>
			<view class="content-wrapper">
				<!-- Level Card -->
				<view class="card level-card" @tap="goToLevel">
					<view class="level-left">
						<text class="level-crown">ğŸ‘‘</text>
						<view class="level-info">
							<text class="level-title">å½“å‰ç­‰çº§ï¼š{{ overview?.level?.name || 'æ™®é€šä¼šå‘˜' }}</text>
							<text class="level-desc">å‡çº§äº«å—æ›´é«˜æƒç›Š</text>
						</view>
					</view>
					<view class="level-btn">
						<text class="level-btn-text">å»å‡çº§</text>
					</view>
				</view>

				<!-- Menu Grid (Optional, if design has extra menus, otherwise stick to design) -->
				<!-- The design mainly highlights the top card and recent list. We can keep other menus if needed or hide them. -->
				
				<!-- Recent List -->
				<view class="section-title">æœ€è¿‘åŠ¨æ€</view>
				<view class="recent-list">
					<view v-for="(item, index) in recentList" :key="index" class="card recent-item">
						<view class="recent-icon-box">
							<uni-icons type="notification" size="20" color="#0052d9"></uni-icons>
						</view>
						<view class="recent-info">
							<text class="recent-text">{{ item.content }}</text>
							<text class="recent-time">{{ item.time }}</text>
						</view>
					</view>
				</view>
			</view>
		</scroll-view>
	</view>
</template>

<script lang="uts">
	// import { getOverview } from "@/services/promo";
	// import type { PromoOverview } from "@/services/promo";

	type PromoOverview = {
		wallet: {
			balance: string,
			total_income: string,
			deposit: string
		},
		level: {
			name: string
		},
		team_count: number,
		performance: {
			personal_total: string,
			team_total: string,
			growth: string
		}
	}

	export default {
		data() {
			return {
				overview: null as PromoOverview | null,
				loading: false,
				recentList: [
					{ content: 'ç”¨æˆ·***åŠ å…¥å›¢é˜Ÿ', time: '10åˆ†é’Ÿå‰' },
					{ content: 'è·å¾—ç›´æ¨å¥–åŠ± 10.00å…ƒ', time: '30åˆ†é’Ÿå‰' },
					{ content: 'å›¢é˜Ÿæˆå‘˜å®Œæˆä»»åŠ¡', time: '1å°æ—¶å‰' }
				]
			};
		},
		onShow() {
			this.loadData();
		},
		methods: {
			loadData() {
				this.loading = true;
				// Mock data
				setTimeout(() => {
					this.overview = {
						wallet: {
							balance: '12580.00',
							total_income: '56800.00',
							deposit: '5000.00'
						},
						level: {
							name: 'VIPä¼šå‘˜'
						},
						team_count: 156,
						performance: {
							personal_total: '5000.00',
							team_total: '120000.00',
							growth: '15%'
						}
					};
					this.loading = false;
				}, 500);
			},
			goTo(path : string) {
				uni.navigateTo({ url: path });
			},
			goToLevel() {
				uni.navigateTo({ url: '/pages/promo/level' });
			}
		}
	};
</script>

<style>
.page-container {
	display: flex;
	flex-direction: column;
	background-color: #f5f7fa;
	height: 100vh;
}

/* Header */
.promo-header {
	background-color: #0052d9;
	padding-bottom: 48rpx;
}

.header-nav {
	height: 88rpx;
	display: flex;
	align-items: center;
	justify-content: center;
	/* Status bar spacing would be handled by a safe-area view usually */
	padding-top: 20rpx; 
}

.nav-title {
	font-size: 34rpx;
	color: #ffffff;
	font-weight: 600;
}

.header-card {
	margin-top: 32rpx;
	padding: 0 32rpx;
}

.stats-row {
	display: flex;
	flex-direction: row;
	justify-content: space-between;
	margin-bottom: 48rpx;
}

.stat-item {
	display: flex;
	flex-direction: column;
	align-items: center;
}

.stat-num {
	font-size: 40rpx;
	color: #ffffff;
	font-weight: 700;
}

.stat-desc {
	font-size: 24rpx;
	color: rgba(255, 255, 255, 0.8);
	margin-top: 8rpx;
}

.quick-row {
	display: flex;
	flex-direction: row;
	justify-content: space-between;
}

.quick-item {
	display: flex;
	flex-direction: column;
	align-items: center;
}

.quick-icon-box {
	width: 88rpx;
	height: 88rpx;
	background-color: rgba(255, 255, 255, 0.2);
	border-radius: 44rpx;
	display: flex;
	align-items: center;
	justify-content: center;
	margin-bottom: 16rpx;
}

.quick-icon {
	font-size: 44rpx;
}

.quick-text {
	font-size: 24rpx;
	color: #ffffff;
}

/* Content */
.content {
	flex: 1;
	height: 0;
}

.content-wrapper {
	padding: 32rpx;
	display: flex;
	flex-direction: column;
	gap: 24rpx;
}

.card {
	background-color: #ffffff;
	border-radius: 24rpx;
	padding: 32rpx;
}

/* Level Card */
.level-card {
	display: flex;
	flex-direction: row;
	align-items: center;
	justify-content: space-between;
	background: linear-gradient(90deg, #fff0cd 0%, #ffdb8e 100%);
}

.level-left {
	display: flex;
	flex-direction: row;
	align-items: center;
	gap: 24rpx;
}

.level-crown {
	font-size: 64rpx;
}

.level-info {
	display: flex;
	flex-direction: column;
	gap: 8rpx;
}

.level-title {
	font-size: 32rpx;
	color: #593e0e;
	font-weight: 700;
}

.level-desc {
	font-size: 24rpx;
	color: rgba(89, 62, 14, 0.7);
}

.level-btn {
	background-color: #593e0e;
	padding: 12rpx 24rpx;
	border-radius: 32rpx;
}

.level-btn-text {
	color: #ffdb8e;
	font-size: 24rpx;
	font-weight: 500;
}

/* Recent List */
.section-title {
	font-size: 32rpx;
	font-weight: 600;
	color: #1f2329;
	margin-top: 16rpx;
}

.recent-list {
	display: flex;
	flex-direction: column;
	gap: 16rpx;
}

.recent-item {
	display: flex;
	flex-direction: row;
	align-items: center;
	gap: 24rpx;
	padding: 24rpx;
}

.recent-icon-box {
	width: 80rpx;
	height: 80rpx;
	background-color: #f5f7fa;
	border-radius: 40rpx;
	display: flex;
	align-items: center;
	justify-content: center;
}

.recent-icon {
	font-size: 40rpx;
}

.recent-info {
	display: flex;
	flex-direction: column;
	gap: 8rpx;
}

.recent-text {
	font-size: 28rpx;
	color: #1f2329;
}

.recent-time {
	font-size: 24rpx;
	color: #999999;
}
</style>
