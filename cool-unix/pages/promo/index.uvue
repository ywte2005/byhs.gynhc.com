<template>
	<view class="flex flex-col h-screen bg-[#f5f7fa]">
		<!-- Header -->
		<cl-topbar title="æ¨å¹¿ä¸­å¿ƒ" :show-back="false" background-color="#0052d9" color="#ffffff" safe-area-top></cl-topbar>

		<view class="bg-[#0052d9] pb-[48rpx]">
			<view class="mt-[32rpx] px-[32rpx]">
				<!-- Stats -->
				<view class="flex flex-row justify-between mb-[48rpx]">
					<view class="flex flex-col items-center">
						<text class="text-[40rpx] text-white font-bold">{{ overview?.wallet?.balance || '0.00' }}</text>
						<text class="text-[24rpx] text-white/80 mt-[8rpx]">å¯æç°(å…ƒ)</text>
					</view>
					<view class="flex flex-col items-center">
						<text class="text-[40rpx] text-white font-bold">{{ overview?.wallet?.total_income || '0.00' }}</text>
						<text class="text-[24rpx] text-white/80 mt-[8rpx]">ç´¯è®¡æ”¶ç›Š(å…ƒ)</text>
					</view>
					<view class="flex flex-col items-center">
						<text class="text-[40rpx] text-white font-bold">{{ overview?.team_count || 0 }}</text>
						<text class="text-[24rpx] text-white/80 mt-[8rpx]">å›¢é˜Ÿäººæ•°</text>
					</view>
				</view>

				<!-- Quick Actions -->
				<view class="flex flex-row justify-between">
					<view class="flex flex-col items-center" @tap="goTo('/pages/wallet/withdraw')">
						<view class="w-[88rpx] h-[88rpx] bg-white/20 rounded-[44rpx] flex items-center justify-center mb-[16rpx]">
							<uni-icons type="vip" size="22" color="#0052d9"></uni-icons>
						</view>
						<text class="text-[24rpx] text-white">ç«‹å³æç°</text>
					</view>
					<view class="flex flex-col items-center" @tap="goTo('/pages/promo/invite')">
						<view class="w-[88rpx] h-[88rpx] bg-white/20 rounded-[44rpx] flex items-center justify-center mb-[16rpx]">
							<uni-icons type="contact" size="22" color="#00b578"></uni-icons>
						</view>
						<text class="text-[24rpx] text-white">é‚€è¯·å¥½å‹</text>
					</view>
					<view class="flex flex-col items-center" @tap="goTo('/pages/promo/commission')">
						<view class="w-[88rpx] h-[88rpx] bg-white/20 rounded-[44rpx] flex items-center justify-center mb-[16rpx]">
							<uni-icons type="wallet" size="22" color="#faad14"></uni-icons>
						</view>
						<text class="text-[24rpx] text-white">ä½£é‡‘æ˜ç»†</text>
					</view>
					<view class="flex flex-col items-center" @tap="goTo('/pages/promo/team')">
						<view class="w-[88rpx] h-[88rpx] bg-white/20 rounded-[44rpx] flex items-center justify-center mb-[16rpx]">
							<uni-icons type="bars" size="22" color="#5856d6"></uni-icons>
						</view>
						<text class="text-[24rpx] text-white">å›¢é˜Ÿç®¡ç†</text>
					</view>
				</view>
			</view>
		</view>

		<scroll-view class="flex-1 h-0" scroll-y>
			<view class="p-[32rpx] flex flex-col gap-[24rpx]">
				<!-- Level Card -->
				<view class="bg-white rounded-[24rpx] p-[32rpx] flex flex-row items-center justify-between bg-gradient-to-r from-[#fff0cd] to-[#ffdb8e]" @tap="goToLevel">
					<view class="flex flex-row items-center gap-[24rpx]">
						<text class="text-[64rpx]">ğŸ‘‘</text>
						<view class="flex flex-col gap-[8rpx]">
							<text class="text-[32rpx] text-[#593e0e] font-bold">å½“å‰ç­‰çº§ï¼š{{ overview?.level?.name || 'æ™®é€šä¼šå‘˜' }}</text>
							<text class="text-[24rpx] text-[#593e0e]/70">å‡çº§äº«å—æ›´é«˜æƒç›Š</text>
						</view>
					</view>
					<view class="bg-[#593e0e] px-[24rpx] py-[12rpx] rounded-[32rpx]">
						<text class="text-[#ffdb8e] text-[24rpx] font-medium">å»å‡çº§</text>
					</view>
				</view>

				<!-- Recent List -->
				<view class="text-[32rpx] font-semibold text-[#1f2329] mt-[16rpx]">æœ€è¿‘åŠ¨æ€</view>
				<view class="flex flex-col gap-[16rpx]">
					<view v-for="(item, index) in recentList" :key="index" class="bg-white rounded-[24rpx] p-[32rpx] flex flex-row items-center gap-[24rpx]">
						<view class="w-[80rpx] h-[80rpx] bg-[#f5f7fa] rounded-[40rpx] flex items-center justify-center">
							<uni-icons type="notification" size="20" color="#0052d9"></uni-icons>
						</view>
						<view class="flex flex-col gap-[8rpx]">
							<text class="text-[28rpx] text-[#1f2329]">{{ item.content }}</text>
							<text class="text-[24rpx] text-[#999999]">{{ item.time }}</text>
						</view>
					</view>
				</view>
			</view>
		</scroll-view>

		<custom-tabbar></custom-tabbar>
	</view>
</template>

<script lang="uts">
	// import { getOverview } from "@/services/promo";
	// import type { PromoOverview } from "@/services/promo";
	import CustomTabbar from '@/components/custom-tabbar/custom-tabbar.uvue';

	type PromoOverview = {
		wallet: {
			balance: string,
			total_income: string,
			deposit: string
		},
		level: {
			name: string
		},
		team_count: number,
		performance: {
			personal_total: string,
			team_total: string,
			growth: string
		}
	}

	export default {
		components: {
			CustomTabbar
		},
		data() {
			return {
				overview: null as PromoOverview | null,
				loading: false,
				recentList: [
					{ content: 'ç”¨æˆ·***åŠ å…¥å›¢é˜Ÿ', time: '10åˆ†é’Ÿå‰' },
					{ content: 'è·å¾—ç›´æ¨å¥–åŠ± 10.00å…ƒ', time: '30åˆ†é’Ÿå‰' },
					{ content: 'å›¢é˜Ÿæˆå‘˜å®Œæˆä»»åŠ¡', time: '1å°æ—¶å‰' }
				]
			};
		},
		onShow() {
			this.loadData();
		},
		methods: {
			loadData() {
				this.loading = true;
				// Mock data
				setTimeout(() => {
					this.overview = {
						wallet: {
							balance: '12580.00',
							total_income: '56800.00',
							deposit: '5000.00'
						},
						level: {
							name: 'VIPä¼šå‘˜'
						},
						team_count: 156,
						performance: {
							personal_total: '5000.00',
							team_total: '120000.00',
							growth: '15%'
						}
					};
					this.loading = false;
				}, 500);
			},
			goTo(path : string) {
				uni.navigateTo({ url: path });
			},
			goToLevel() {
				uni.navigateTo({ url: '/pages/promo/level' });
			}
		}
	};
</script>

<style>
</style>
